Driver Monitoring System (DMS) for Fatigue & Distraction DetectionA high-performance, real-time safety system developed using Python, OpenCV, and Dlib. This system monitors driver behavior to detect drowsiness, yawning, and distraction by analyzing facial geometry and 3D head pose estimation.ğŸš€ Features1. Advanced Drowsiness DetectionEAR Algorithm: Utilizes the Eye Aspect Ratio (EAR) to detect prolonged eye closure.Pose-Invariant EAR: Uses max(left_eye, right_eye) to prevent false alarms when the driver turns their head to check mirrors.PERCLOS Metric: Calculates the Percentage of Eye Closure over a 300-frame sliding windowâ€”an industry-standard metric for measuring physiological fatigue.2. Distraction MonitoringHead Pose Estimation: Implements the SolvePnP (Perspective-n-Point) algorithm.Yaw & Pitch Tracking: Detects if the driver is looking away from the road (Yaw) or down at a mobile device (Pitch).3. Yawn DetectionMAR Algorithm: Monitors the Mouth Aspect Ratio (MAR) to identify repetitive yawning patterns.4. Robust Image PipelineCLAHE Enhancement: Uses Contrast Limited Adaptive Histogram Equalization to normalize illumination, ensuring the system works in low-light or high-glare conditions.Asynchronous Alerts: Multi-threaded audio system ensures the video feed never "freezes" while playing alarms.ğŸ“ Technical ArchitectureThe EAR FormulaThe system calculates the vertical and horizontal distances between eyelid landmarks:$$EAR = \frac{||p2 - p6|| + ||p3 - p5||}{2.0 \times ||p1 - p4||}$$3D Head PoseBy mapping 2D image coordinates to a 3D generic facial model, we derive rotation vectors for the head:Pitch: Indicates "Nodding" (Sleeping or looking at phone).Yaw: Indicates "Shaking" (Looking at side mirrors/passengers).ğŸ“‚ Project StructurePlaintextDriver-DMS/
â”œâ”€â”€ driver_safety.py          # Main application logic
â”œâ”€â”€ alarm.wav                 # Audio alert file (Required)
â”œâ”€â”€ requirements.txt          # Python dependencies
â”œâ”€â”€ .gitignore                # Prevents large .dat files from being uploaded
â””â”€â”€ README.md                 # Project documentation
ğŸ› ï¸ Installation & Usage1. PrerequisitesPython 3.8+A working Webcam2. SetupClone the repository and install the required libraries:Bashgit clone https://github.com/YOUR_USERNAME/Driver-DMS.git
cd Driver-DMS
pip install -r requirements.txt
3. Landmark PredictorThe system requires the pre-trained Dlib 68-point landmark model.Download shape_predictor_68_face_landmarks.dat from Dlib's official site.Extract the file and place it in the project root folder.4. Run the SystemBashpython driver_safety.py
ESC Key: Exit the application.ğŸ“ Performance MetricsFrame Rate: ~25-30 FPS (on standard CPU).Metric Sensitivity: Adjustable EAR_THRESHOLD (Default: 0.20).Lighting: Optimized for cabin environments via CLAHE.ğŸ¤ Contribution & LicenseThis project was developed as a 3rd-year AIML Engineering project.License: MIT